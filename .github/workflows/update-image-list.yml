name: Update image_list1.json

on:
  push:
    paths:
      - 'img/**'

permissions:
  contents: write  # âœ… å…è®¸ GitHub Actions å†™å…¥ä»“åº“

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Generate image_list.json (sorted by filename)
        run: |
          echo "ğŸ” è¯»å– img/ ä¸‹æ‰€æœ‰å›¾ç‰‡..."
          node -e "
            const fs = require('fs');
            const path = require('path');
            const dir = 'img';
            const files = fs.readdirSync(dir)
              .filter(f => /\.(jpe?g|png)$/i.test(f))
              .sort(); // æŒ‰æ–‡ä»¶åæ’åº
            console.log('âœ… è·å–åˆ°æ–‡ä»¶:', files);
            fs.writeFileSync(path.join(dir, 'image_list.json'), JSON.stringify(files, null, 2));
          "

      - name: Commit and push updated image_list.json
        run: |
          git config user.name github-actions
          git config user.email actions@github.com
          git add img/image_list.json
          git commit -m "ğŸ¤– Auto update image_list.json" || echo "âœ… æ— éœ€æäº¤"
          git push
